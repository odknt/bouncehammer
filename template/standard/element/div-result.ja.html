[%- IF onlineparse == 1 -%]
	[%- SET UpdatedName = "解析実行日時" -%]
	[%- SET DisplayProp = "none" -%]
[%- ELSE -%]
	[%- SET UpdatedName = "記録更新日時" -%]
	[%- SET DisplayProp = "inline" -%]
[%- END -%]
[% FOREACH B = bouncemessages %]
	[%- IF isupdated == 1 -%]
		[%- SET displayproperty = 'block' -%]
	[%- ELSE -%]
		[%- SET displayproperty = 'none' -%]
	[%- END -%]
	<div id = 'record-of-[% B.id %]' class = 'record'>
		<div class = 'recordsummary' id = 'summary-of-[% B.id %]'>
			<div class = 'number-in-summary'>
				<span class = 'reason [% B.reason %]'>&nbsp; &nbsp; &nbsp;</span>&nbsp;
				# [% B.id %]
			</div>
			<div class = 'status-in-summary'>
				<span class = 'flatbutton'>
				<a href = "javascript:void(0)" 
					onClick = "toggleIt('details-of-[% B.id %]');">詳細</a>
				</span>
			</div>
			<div class = 'fields-in-summary'>
				発信: <strong>[% B.addresser %]</strong> ([% B.frequency %]回)<br />
				宛先: <strong>&lt;[% B.recipient %]&gt;</strong><br />
				差戻理由: <strong>[[% B.reason %]]</strong> 差戻日時: [% B.bounced %]
				[%- IF tzoffset != B.tzoffset -%] [% tzoffset %][%- END -%]
			</div>

			<div class = 'recorddetails' id = 'details-of-[% B.id %]' style = 'display: [% displayproperty %];'>
				<h4>記録の詳細</h4>
				[%- prototype.form_remote_tag( {
						url => "${scriptname}/update/${B.id}",
						update => "record-of-${B.id}",
						loading => "disableIt('do-update-${B.id}');",
					});
				-%]
				<table>
				<tbody>
					<tr>
						<td class = 'key'>記録のID</td>
						<td class = 'value'>[% B.id %]</td>
						<td class = 'extra'>
							<input type = 'hidden' name = 'id' value = '[% B.id %]' />
							<input type = 'hidden' name = 'language' value = '[% mylanguage %]' />
						</td>
					</tr>

					<tr>
						<td class = 'key'>発信者アドレス(From:)</td>
						<td class = 'value'>[% B.addresser %] / [% B.senderdomain %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>宛先アドレス(To:)</td>
						<td class = 'value'>[% B.recipient %] / [% B.destination %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>差戻回数</td>
						<td class = 'value'>[% B.frequency %] 回</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>差戻理由</td>
						<td class = 'value'>[% INCLUDE "select-reason.${mylanguage}.html" %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>宛先分類</td>
						<td class = 'value'>[% INCLUDE "select-hostgroup.${mylanguage}.html" %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>エラー内容抜粋</td>
						<td class = 'value' style = "font-style: italic;">[% B.diagnosticcode %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>トークン(MD5)</td>
						<td class = 'value'>
							<span class = 'token'>
								<input type = 'text' value = '[% B.token %]' />
							</span>
						</td>
						<td class = 'extra'>
							<input type = 'hidden' name = 'token' value = '[% B.token %]' />
						</td>
					</tr>

					<tr>
						<td class = 'key'>差戻日時</td>
						<td class = 'value'>
							[% B.bounced %]
							[%- IF tzoffset != B.tzoffset -%] [% tzoffset %] &lt;- ([% B.tzoffset %])[%- END -%]
						</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>[% UpdatedName %]</td>
						<td class = 'value'>
							[%- IF isupdated == 1 -%]<strong>[%- END -%]
							[% B.updated %]
							[%- IF isupdated == 1 -%]</strong>[%- END -%]
						</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>
							<input type = 'submit' id = 'do-update-[% B.id %]' style = 'display: [% DisplayProp %];' 
								class = 'flatbutton' value = '更新' disabled onClick = "this.value = '更新中...';" />
						</td >
						<td class = 'value'> </td>
						<td class = 'extra'> </td>
					</tr>
				</tbody>
				</table>
				</form>
			</div>
		</div>
	</div>
[% END %]
