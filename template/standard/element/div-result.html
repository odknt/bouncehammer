[%- PROCESS "heads.tt" -%]
[%- PROCESS "words.tt" -%]
[%- PROCESS "terms.tt" -%]
[%- PROCESS "hostgroup.tt" -%]
[%- PROCESS "reason.tt" -%]
[%- PROCESS "error.tt" -%]
[%- PROCESS "desc.tt" -%]
[%- IF onlineparse == 1 -%]
	[%- SET ShowsButton = "none" -%]
[%- ELSE -%]
	[%- SET ShowsButton = "inline" -%]
[%- END -%]
[% FOREACH B = bouncemessages %]
	[%- IF isupdated == 1 -%]
		[%- SET showsdetail = 'block' -%]
	[%- ELSE -%]
		[%- SET showsdetail = 'none' -%]
		[%- IF isremoved == 1 -%]
			[%- SET removedclassname = 'isremoved' -%]
		[%- END -%]
	[%- END -%]
	<div id = 'record-of-[% B.id %]' class = 'record'>
		<div class = 'recordsummary [%- removedclassname -%]' id = 'summary-of-[% B.id %]'>
			<div class = 'number-in-summary'>
				<div class = 'id'># [% B.id %]</div>
				[%- IF isremoved == 1 -%]
					<div class = 'reason void' title = 'reason.${B.reason} %]'>[% B.reason %]</div>
				[%- ELSE -%]
					<div class = 'reason [% B.reason %]' title = '[% reason.${B.reason} %]'>[% B.reason %]</div>
				[%- END -%]
			</div>
			<div class = 'status-in-summary'>
				[%- IF isremoved == 1 -%]
					<div class = 'frequency' style = 'color: #2b2b2; font-size: 10px; font-weight: bold;'>[% word.removed %]</div>
				[%- ELSE -%]
					<div class = 'frequency'>[% B.frequency %]</div>
					<span class = 'flatbutton'>
					<a href = "javascript:void(0)" 
						onClick = "toggleIt('details-of-[% B.id %]');">[% word.detail %]</a>
					</span>
				[%- END -%]
			</div>
			<div class = 'fields-in-summary'>
				<table><tbody>
					<tr>
						<td class = 'key-in-summary'>From:</td>
						<td class = 'value-in-summary'>
							<input type = 'text' class = 'emailaddress'
								onClick = 'this.select();' value = '[% B.addresser %]' />
						</td>
					</tr>
					<tr>
						<td class = 'key-in-summary'>To:</td>
						<td class = 'value-in-summary'>
							<input type = 'text' class = 'emailaddress'
								onClick = 'this.select();' value = '[% B.recipient %]' />
						</td>
					</tr>
					<tr>
						<td class = 'key-in-summary'>Date:</td>
						<td class = 'value-in-summary'>[% B.bounced %]</td>
					</tr>
				</tbody></table>
			</div>

			<div class = 'recorddetails' id = 'details-of-[% B.id %]' style = 'display: [% showsdetail %];'>
				<h4>[% head.recorddetails %]</h4>
				[%- prototype.form_remote_tag( {
						url => "${scriptname}/update/${B.id}",
						update => "record-of-${B.id}",
						loading => "disableIt('do-update-${B.id}');",
					});
				-%]
				<table>
				<tbody>
					<tr>
						<td class = 'key'>[% word.record %] ID</td>
						<td class = 'value'>[% B.id %]</td>
						<td class = 'extra'>
							<input type = 'hidden' name = 'id' value = '[% B.id %]' />
							<input type = 'hidden' name = 'language' value = '[% mylanguage %]' />
						</td>
					</tr>

					<tr>
						<td class = 'key'>[% term.addresser %]|From:</td>
						<td class = 'value'>
							<input type = 'text' class = 'selectable' onClick = 'this.select();' value = '[% B.addresser %]' />
						</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>[% term.recipient %]|To:</td>
						<td class = 'value'>
							<input type = 'text' class = 'selectable' onClick = 'this.select();' value = '[% B.recipient %]' />
						</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>[% term.frequency %]</td>
						<td class = 'value'>[% B.frequency %] [% word.unitoftimes %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>[% term.reason %]</td>
						<td class = 'value'>[% INCLUDE "select-reason.html" %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>[% term.hostgroup %]</td>
						<td class = 'value'>[% INCLUDE "select-hostgroup.html" %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>[% term.provider %]</td>
						<td class = 'value'>[% B.provider %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>[% word.diagnosticcode %]</td>
						<td class = 'value' style = "font-style: italic;">[% B.diagnosticcode %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>[% term.token %](MD5)</td>
						<td class = 'value'>
							<input type = 'text' class = 'selectable' value = '[% B.token %]' onClick = 'this.select();' />
						</td>
						<td class = 'extra'>
							<input type = 'hidden' name = 'token' value = '[% B.token %]' />
						</td>
					</tr>

					<tr>
						<td class = 'key'>[% term.bounced %]</td>
						<td class = 'value'>
							[% B.bounced %]
							[%- IF tzoffset != B.tzoffset -%] [% tzoffset %] &lt;- ([% B.tzoffset %])[%- END -%]
						</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>[% term.updated %]</td>
						<td class = 'value'>
							[%- IF isupdated == 1 -%]<strong>[%- END -%]
							[% B.updated %]
							[%- IF isupdated == 1 -%]</strong>[%- END -%]
						</td>
						<td class = 'extra'>
						</td>
					</tr>
				</tbody>
				</table>
				<input type = 'submit' id = 'do-update-[% B.id %]' style = 'display: [% ShowsButton %];'
					class = 'flatbutton' value = '[%- word.update -%]' disabled 
					onClick = "this.value = '[%- word.updating -%]';" />
				</form>

				[%- prototype.form_remote_tag( {
						url => "${scriptname}/delete/${B.id}",
						update => "record-of-${B.id}",
						loading => "disableIt('do-delete-${B.id}');",
					});
				-%]
				<input type = 'hidden' name = 'token' value = '[% B.token %]' />
				<input type = 'submit' id = 'do-delete-[% B.id %]' style = 'display: [% ShowsButton %];'
					class = 'flatbutton caution' value = '[%- word.delete -%]' disabled 
					onClick = "this.value = '[%- word.deleting -%]';" />
				[%- IF isreadonly == 0 -%]
				<input type = 'checkbox' name = 'enabledelete' 
					onChange = "
						if( this.checked == true ){
							enableIt('do-delete-[% B.id %]');
							disableIt('do-update-[% B.id %]');
							disableIt('reasons-of-[% B.id %]');
							disableIt('hostgroups-of-[% B.id %]');
						}
						else{
							disableIt('do-delete-[% B.id %]');
							enableIt('reasons-of-[% B.id %]');
							enableIt('hostgroups-of-[% B.id %]');
						}"/> &larr; [% desc.checktodelete %]
				[%- END -%]
				</form>
			</div>
		</div>
	</div>
[% END %]
